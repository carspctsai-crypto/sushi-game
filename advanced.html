<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å‡åå£½å¸å¤§å¸« Pro - è¡Œå‹•å„ªåŒ–ç‰ˆ</title>
    <style>
        :root { --wood: #e67e22; --gold: #f1c40f; --bg: #fdf2e9; --sushi-red: #e74c3c; }
        
        body { 
            font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif; 
            background-color: var(--bg); 
            text-align: center; 
            margin: 0; 
            padding: 10px;
            display: flex;
            justify-content: center;
        }

        .game-area { 
            width: 100%;
            max-width: 500px; 
            background: white; 
            padding: 15px; 
            border-radius: 20px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
            border: 6px solid var(--wood);
            box-sizing: border-box;
        }
        
        /* ç‹€æ…‹åˆ— */
        .status { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 10px;
        }
        .rank-badge { 
            background: var(--gold); 
            color: #7f4f24; 
            padding: 4px 10px; 
            border-radius: 15px; 
            font-weight: bold; 
            font-size: 12px; 
        }

        /* è¨‚å–®å€åŸŸ */
        .order-zone { 
            background: #fff; 
            border: 2px dashed #ccc; 
            padding: 15px 10px; 
            margin-bottom: 15px; 
            border-radius: 10px; 
        }
        .target-word { font-size: 18px; color: #7f8c8d; margin-bottom: 10px; font-weight: bold; }
        .spelling-slots { 
            display: flex; 
            justify-content: center; 
            flex-wrap: wrap; /* è¶…éå¯¬åº¦è‡ªå‹•æ›è¡Œ */
            gap: 8px; 
            min-height: 50px; 
        }
        .slot { 
            width: 35px; 
            height: 45px; 
            border-bottom: 3px solid var(--wood); 
            font-size: 28px; 
            color: var(--sushi-red); 
            font-weight: bold; 
        }

        /* å£½å¸å‚³é€å¸¶ (ä¹å®®æ ¼æ”¹ç‚ºæ›´ç·Šå¯†æ’åˆ—) */
        .conveyor-belt { 
            display: grid; 
            grid-template-columns: repeat(4, 1fr); 
            gap: 8px; 
            background: #f0f0f0; 
            padding: 12px; 
            border-radius: 10px; 
        }
        .sushi-plate { 
            cursor: pointer; 
            background: white; 
            border-radius: 50%; 
            aspect-ratio: 1 / 1; /* ä¿æŒåœ“å½¢ */
            display: flex; 
            align-items: center; 
            justify-content: center; 
            box-shadow: 0 3px 0 #ddd; 
            border: 2px solid #ddd; 
            -webkit-tap-highlight-color: transparent;
        }
        .kana { font-size: 22px; font-weight: bold; }

        /* æç¤ºç‰¹æ•ˆ */
        @keyframes hint-glow {
            0% { border-color: var(--gold); transform: scale(1); }
            50% { border-color: #ff5722; transform: scale(1.05); box-shadow: 0 0 15px var(--gold); }
            100% { border-color: var(--gold); transform: scale(1); }
        }
        .hint-active { animation: hint-glow 0.8s infinite; z-index: 5; border-width: 3px; }

        .msg { height: 24px; color: #d35400; font-weight: bold; margin: 10px 0; font-size: 15px; }
    </style>
</head>
<body>

    <div class="game-area">
        <div class="status">
            <div id="rank-display" class="rank-badge">åº—èˆ–ç­‰ç´šï¼šæ–°æ‰‹è·¯é‚Šæ”¤</div>
            <div style="font-size: 14px;">ç‡Ÿæ”¶: <span id="score" style="color: var(--sushi-red);">0</span> å††</div>
        </div>

        <div class="order-zone">
            <div id="target-romaji" class="target-word">å®¢äººæ­£åœ¨çœ‹èœå–®...</div>
            <div id="spelling-area" class="spelling-slots"></div>
        </div>

        <div id="msg" class="msg">æ­¡è¿å…‰è‡¨ï¼</div>
        <div class="conveyor-belt" id="belt"></div>
        
        <p style="font-size: 11px; color: #999; margin-top: 15px;">â€» é€£çºŒé¸éŒ¯å…©æ¬¡æœƒå‡ºç¾é–ƒçˆæç¤º</p>
    </div>

<script>
    const orders = [
        { word: 'å£½å¸', romaji: 'SU-SHI', kana: ['ã™', 'ã—'] },
        { word: 'ç›¸æ©Ÿ', romaji: 'KA-ME-RA', kana: ['ã‚«', 'ãƒ¡', 'ãƒ©'] },
        { word: 'æ¼¢å ¡', romaji: 'HA-N-BA-A-GAA', kana: ['ãƒ', 'ãƒ³', 'ãƒ', 'ãƒ¼', 'ã‚¬', 'ãƒ¼'] },
        { word: 'éºµåŒ…', romaji: 'PA-N', kana: ['ãƒ‘', 'ãƒ³'] },
        { word: 'é£¯ç³°', romaji: 'O-NI-GI-RI', kana: ['ãŠ', 'ã«', 'ã', 'ã‚Š'] },
        { word: 'æ‹‰éºµ', romaji: 'RA-A-ME-N', kana: ['ã‚‰', 'ãƒ¼', 'ã‚', 'ã‚“'] }
    ];

    const ranks = [
        { min: 0, name: "æ–°æ‰‹è·¯é‚Šæ”¤" },
        { min: 1000, name: "äººæ°£å±…é…’å±‹" },
        { min: 3000, name: "çŸ¥åå£½å¸åº—" },
        { min: 6000, name: "å‚³èªªä¸­çš„å£½å¸ç¥" }
    ];

    let currentOrder = null, userInput = [], score = 0, wrongCount = 0;

    function speak(text) {
        if ('speechSynthesis' in window) {
            const msg = new SpeechSynthesisUtterance();
            msg.text = text;
            msg.lang = 'ja-JP';
            window.speechSynthesis.speak(msg);
        }
    }

    function initOrder() {
        currentOrder = orders[Math.floor(Math.random() * orders.length)];
        userInput = []; wrongCount = 0;
        document.getElementById('target-romaji').innerText = `è¨‚å–®ï¼š${currentOrder.word} (${currentOrder.romaji})`;
        document.getElementById('msg').innerText = "è«‹ç…§é †åºé»é¸å‡åï¼";
        
        const area = document.getElementById('spelling-area');
        area.innerHTML = '';
        currentOrder.kana.forEach(() => {
            const slot = document.createElement('div');
            slot.className = 'slot';
            area.appendChild(slot);
        });
        generateBelt();
    }

    function generateBelt() {
        const belt = document.getElementById('belt');
        belt.innerHTML = '';
        let pool = [...currentOrder.kana];
        const fillers = ['ã‚','ã„','ã†','ãˆ','ãŠ','ã‹','ãŒ','ã','ã','ã±','ãƒ”','ãƒ¬','ã‚·','ãƒ³','ã©'];
        while(pool.length < 12) {
            let r = fillers[Math.floor(Math.random() * fillers.length)];
            if(!pool.includes(r)) pool.push(r);
        }
        pool.sort(() => Math.random() - 0.5);

        pool.forEach(k => {
            const plate = document.createElement('div');
            plate.className = 'sushi-plate';
            plate.dataset.kana = k;
            plate.innerHTML = `<span class="kana">${k}</span>`;
            plate.onclick = () => selectKana(k, plate);
            belt.appendChild(plate);
        });
    }

    function selectKana(k, element) {
        const nextCorrectKana = currentOrder.kana[userInput.length];
        if (k === nextCorrectKana) {
            speak(k);
            userInput.push(k);
            document.querySelectorAll('.slot')[userInput.length - 1].innerText = k;
            document.querySelectorAll('.sushi-plate').forEach(p => p.classList.remove('hint-active'));
            wrongCount = 0;
            if (userInput.length === currentOrder.kana.length) completeOrder();
        } else {
            wrongCount++;
            speak("é•ã„ã¾ã™");
            document.getElementById('msg').innerText = "âŒ é»éŒ¯äº†å–”ï¼";
            if (wrongCount >= 2) showHint();
        }
    }

    function showHint() {
        const nextCorrect = currentOrder.kana[userInput.length];
        document.querySelectorAll('.sushi-plate').forEach(p => {
            if (p.dataset.kana === nextCorrect) p.classList.add('hint-active');
        });
        document.getElementById('msg').innerText = "ğŸ’¡ æç¤ºï¼šçœ‹é–ƒçˆçš„å£½å¸ï¼";
    }

    function completeOrder() {
        score += 500;
        document.getElementById('score').innerText = score;
        document.getElementById('msg').innerText = "ğŸ‰ å®Œç¾ï¼å¾—åˆ° 500 å††ï¼";
        speak("ç´ æ™´ã‚‰ã—ã„");
        
        const rank = ranks.slice().reverse().find(r => score >= r.min);
        document.getElementById('rank-display').innerText = `åº—èˆ–ç­‰ç´šï¼š${rank.name}`;
        
        setTimeout(initOrder, 2000);
    }

    window.onload = initOrder;
</script>
</body>
</html>